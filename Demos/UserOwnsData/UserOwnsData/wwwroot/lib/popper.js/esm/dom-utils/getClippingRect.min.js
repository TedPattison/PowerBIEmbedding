import{viewport}from"../enums.js";import getViewportRect from"./getViewportRect.js";import getDocumentRect from"./getDocumentRect.js";import listScrollParents from"./listScrollParents.js";import getOffsetParent from"./getOffsetParent.js";import getDocumentElement from"./getDocumentElement.js";import getComputedStyle from"./getComputedStyle.js";import{isElement,isHTMLElement}from"./instanceOf.js";import getBoundingClientRect from"./getBoundingClientRect.js";import getDecorations from"./getDecorations.js";import contains from"./contains.js";import rectToClientRect from"../utils/rectToClientRect.js";function getClientRectFromMixedType(t,e){return e===viewport?rectToClientRect(getViewportRect(t)):isHTMLElement(e)?getBoundingClientRect(e):rectToClientRect(getDocumentRect(getDocumentElement(t)))}function getClippingParents(t){var e=listScrollParents(t),o=["absolute","fixed"].indexOf(getComputedStyle(t).position)>=0&&isHTMLElement(t)?getOffsetParent(t):t;return isElement(o)?e.filter(function(t){return isElement(t)&&contains(t,o)}):[]}export default function getClippingRect(t,e,o){var n="clippingParents"===e?getClippingParents(t):[].concat(e),i=[].concat(n,[o]),r=i[0],m=i.reduce(function(e,o){var n=getClientRectFromMixedType(t,o),i=getDecorations(isHTMLElement(o)?o:getDocumentElement(t));return e.top=Math.max(n.top+i.top,e.top),e.right=Math.min(n.right-i.right,e.right),e.bottom=Math.min(n.bottom-i.bottom,e.bottom),e.left=Math.max(n.left+i.left,e.left),e},getClientRectFromMixedType(t,r));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m};